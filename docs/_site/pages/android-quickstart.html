<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>FlowForms Android quickstart</title>
    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="stylesheet" href="/assets/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/androidstudio.min.css">
</head>
<body>
    <div id="main-content">
        <nav id="sidebar-wrapper">
    <ul class="sidebar-nav">
        <div class="rs-row center-main-axis">
            <h4 class="sidebar-brand">FlowForms index</h4>
        </div>
        
        <li> <a href="/" >Home</a> </li>
        
        <li> <a href="/pages/android-quickstart" >Android quickstart</a> </li>
        
        <li> <a href="/pages/kmp-quickstart" >KMP quickstart</a> </li>
        
    </ul>
</nav>

        <div class="rs-row">
            <div id="sidebar-empty-space"></div> <!-- TODO : Remove this on smaller devices -->
            <div class="rs-column center-second-axis">
                <div id="page-content-wrapper">
                    <div class="page-content inset">
                            <h2 id="android-quickstart">Android quickstart</h2>
<p>In order to use FlowForms you just need to make 3 steps :</p>

<p><strong>1 :</strong> Declare a Form, its fields, and their validations using our FlowForms DSL in your ViewModel :</p>

<pre><code class="kotlin">
class SignUpViewModel : ViewModel() {

    var userName: String = "",
    var password: String = ""

    val form = flowForm {
        field(USERNAME, Required { userName })
        field(PASSWORD,
            Required { password },
            MinLength(MIN_PASSWORD_LENGTH) { password }
        )
    }

    companion object {
        const val USERNAME = "username"
        const val PASSWORD = "password"
        const val MIN_PASSWORD_LENGTH = 8
    }
}
</code></pre>
<div class="comment">In the above snippet we are declaring a form with two fields (Username &amp; Password). Both fields are required and the password field also requires to have at least 8 characters. </div>

<p><strong>2 :</strong> Listen to the fields status on your Fragment or Activity using our repeatOnLifeCycleScope extension :</p>

<pre><code class="kotlin">
class SignUpFormFragment : Fragment() {
    ...
    private var binding : SignUpFormBindingFragment? = null
    private lateinit var viewModel : SignUpViewModel

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)
        viewModel = ViewModelProvider(requireActivity())[SignUpViewModel::class.java] // or use you favorite DI tool
        ...
        viewModel.form.fields.value.let {
            repeatOnLifeCycleScope(
                { it[SignUpViewModel.USERNAME]?.status?.collect(::onUserNameStatusChange) },
                { it[SignUpViewModel.PASSWORD]?.status?.collect(::onPasswordStatusChange) },
                { viewModel.form.status.collect(::onFormStatusChange) }
            )
        }
    }

    private fun onUserNameStatusChange(status: FieldStatus) {
        when (status.code) {
            REQUIRED_UNSATISFIED -&gt; binding?.usernameInputLayout.error = getString(R.string.required_field)
            else -&gt; binding?.usernameInputLayout.error = null
        }
    }

    private fun onPasswordStatusChange(status: FieldStatus) {
        when (status.code) {
            REQUIRED_UNSATISFIED -&gt; binding?.passwordInputLayout.error = getString(R.string.required_field)
            MIN_LENGTH_UNSATISFIED -&gt; binding?.passwordInputLayout.error = getString(R.string.min_length, SignUpViewModel.MIN_PASSWORD_LENGTH)
            else -&gt; binding?.passwordInputLayout.error = null
        }
    }

    private fun onFormStatusChange(status: FormStatus) {
        when (status.code) {
            CORRECT -&gt; binding?.continueButton.isEnabled = true
            else -&gt; binding?.continueButton.isEnabled = false
        }
    }
}
</code></pre>
<div class="comment">In the above snippet we are collecting (observing) our fields' status and displaying an error message in their input layouts when the field is incorrect (ie. a field's validation failed). Both REQUIRED_UNSATISFIED and MIN_LENGTH_UNSATISFIED are status codes of the fields' validations.
Additionally, we are observing the general form status, enabling a "continue" button when the form is correct (ie. all its fields are correct) and disabling it when any of its fields are incorrect (at least one validation failed on some field)</div>

<p><strong>3 :</strong> Bind your input views to the form fields using our bind form’s extension function :</p>

<pre><code class="kotlin">
class SignUpFormFragment : Fragment() {
    ...
    private var binding : SignUpFormBindingFragment? = null
    private lateinit var viewModel : SignUpViewModel

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)
        viewModel = ViewModelProvider(requireActivity())[SignUpViewModel::class.java] // or use you favorite DI tool
        ...
        bindFields()
    }

    private fun bindFields() {
        binding?.apply {
            viewModel.form.bind(lifecycleScope,
                usernameInputEditText to SignUpFormModel.USERNAME,
                passwordInputEditText to SignUpFormModel.PASSWORD
            )
        }
    }
}
</code></pre>
<div class="comment">In the above snippet we are binding the userName input to the username field in the form, and the password input to the password field. This automatically calls the respective field's validations when any of the inputs change, in our case it is when the user types something in them.</div>

<p>And that’s one of the easiest forms we can create using <strong>FlowForms</strong>, we don’t need to care about managing the field’s validation triggering nor making any complex logic to enable or disable the continue button. 
This quickstart example is also meant to be used with two-way databinding, setting and using our fields’ values directly in our xml layouts as the following :</p>
<pre><code class="xml">
android:text="@={viewModel.userName}"
</code></pre>
<p>For further information about two-way databiding, refer to <a href="https://developer.android.com/topic/libraries/data-binding/two-way">this official documentation</a>. However, the snippets above can be easily adapted to avoid using two-way databinding.</p>

<p><strong>FlowForms</strong>’s full potential is better appreciated when making more complex forms, you can review the <a href="https://github.com/rootstrap/FlowForms/tree/main/ExampleApp%20Android/src/main/java/com/rootstrap/flowforms/example">android example app</a> included the project. Which makes use of asynchronous validations and many other capabilities. You will see that the implementation steps doesn’t change at all.</p>

<p>However, the example app and this guide does not cover all <strong>FlowForms</strong>’s features, so for a detailed list of all the available features please refer to the <a href="pages/documentation-index">documentation index</a></p>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/assets/js/jquery-1.10.2.js"></script>
    <script src="/assets/js/main.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.0.0-beta1/highlight.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.0.0-beta1/languages/kotlin.min.js"></script>
    <script>hljs.highlightAll();</script>
</body>
</html>
